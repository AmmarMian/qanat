<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="3 Running experiments through a job system" href="run_job_cluster.html" /><link rel="prev" title="1 Getting Started" href="gettingstarted.html" />

    <!-- Generated with Sphinx 8.2.0 and Furo 2024.08.06 -->
        <title>2 Experiments, Datasets and description files - Qanat 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=cfdaff8d" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #2E3440;
  --color-code-foreground: #d8dee9;
  --font-stack: Roboto, sans-serif;
  --font-stack--monospace: Open Sans, monospace;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>

<div class="announcement">
  <aside class="announcement-content">
     <em>Qanat is currently in alpha. Use at your own risk.</em> 
  </aside>
</div>

<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Qanat 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">Qanat 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../features/index.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../usage/index.html">Usage</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Usage</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usage/vocabulary.html">Concepts and vocabulary</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../usage/running/index.html">Running an experiment</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Running an experiment</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../usage/running/simple.html">Running a simple experiment with command-line arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/running/parameters_file.html">Running with a file containing parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/running/container.html">Running inside a container</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/running/runner.html">Running through a job system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/running/groups.html">Running several groups of parameters in a single run</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/running/commit.html">Running a run at a previous commit of the repository</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/running/rerun.html">Re-run a previous run of an experiment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/exploring_runs.html">Exploring runs of experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usage/progress.html">Showing progress of a run in <code class="code docutils literal notranslate"><span class="pre">qanat</span> <span class="pre">experiment</span> <span class="pre">status</span></code></a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../usage/cli_reference/index.html">CLI Reference</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of CLI Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../usage/cli_reference/init.html">qanat init</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/cli_reference/config.html">qanat config</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/cli_reference/cache.html">qanat cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/cli_reference/dataset.html">qanat dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/cli_reference/document.html">qanat document</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/cli_reference/experiment.html">qanat experiment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/cli_reference/status.html">qanat status</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../usage/description_files/index.html">Description files</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Description files</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../usage/description_files/dataset.html">Dataset description file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/description_files/experiment.html">Experiment description file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../usage/description_files/run.html">Run launching description file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Basics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Basics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gettingstarted.html"><span class="sectnum">1 </span>Getting Started</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#"><span class="sectnum">2 </span>Experiments, Datasets and description files</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_job_cluster.html"><span class="sectnum">3 </span>Running experiments through a job system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/index.html">Advanced tutorials</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../modules.html">qanat</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of qanat</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../qanat.html">qanat package</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of qanat package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../qanat.cli_commands.html">qanat.cli_commands package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../qanat.core.html">qanat.core package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../qanat.utils.html">qanat.utils package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../history.html">History</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/AmmarMian/qanat/blob/main/docsrc/tutorials/basics/experiment_dataset_yaml.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/AmmarMian/qanat/edit/main/docsrc/tutorials/basics/experiment_dataset_yaml.rst" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="experiments-datasets-and-description-files">
<h1><span class="sectnum">2 </span>Experiments, Datasets and description files<a class="headerlink" href="#experiments-datasets-and-description-files" title="Link to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this tutorial, we will see the notion of dataset and its linking to experiments. We will also see how to describe experiments and datasets using a YAML description file rather than from a prompt.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The code of this tutorial is available at: TODO</p>
</div>
<section id="objectives">
<h2><span class="sectnum">2.1 </span>Objectives<a class="headerlink" href="#objectives" title="Link to this heading">¶</a></h2>
<p>In this tutorial we will use the classic IRIS and MNIST datasets to illustrate the notion of dataset and experiment. We will produce the following experiments:</p>
<ul class="simple">
<li><p>A simple experiment on IRIS dataset that will compute summary statistics and a PCA plot.</p></li>
<li><p>A simple experiment on MNIST dataset that will compute summary statistics and a PCA plot.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We rely on python&gt;3.6 and the following packages:
* numpy
* pandas
* matplotlib
* seaborn</p>
<p>So make sure you have them installed before starting this tutorial. You can install them using pip:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pip install numpy pandas matplotlib seaborn</span>
</pre></div>
</div>
<p>We also assume python executable is called with alias <cite>python</cite>.</p>
</div>
</section>
<section id="setting-up-the-project-and-environment">
<h2><span class="sectnum">2.2 </span>Setting up the project and environment<a class="headerlink" href="#setting-up-the-project-and-environment" title="Link to this heading">¶</a></h2>
<p>Let us create a new directory and initialize a new Qanat project:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mkdir iris_mnist</span>
<span class="go">cd iris_mnist</span>
<span class="go">qanat init . --yes</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>–yes</cite> option is used to avoid the interactive prompt. It is useful for scripting.</p>
</div>
<p>Let us also download both IRIS and MNIST datasets:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mkdir data; cd data</span>
<span class="go">wget https://archive.ics.uci.edu/static/public/53/iris.zip</span>
<span class="go">unzip iris.zip -d iris</span>
<span class="go">rm iris.zip</span>

<span class="go">mkdir mnist; cd mnist</span>
<span class="go">wget http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz</span>
<span class="go">wget http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz</span>
<span class="go">wget http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz</span>
<span class="go">wget http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz</span>
<span class="go">gzip -d train-images-idx3-ubyte.gz</span>
<span class="go">gzip -d train-labels-idx1-ubyte.gz</span>
<span class="go">gzip -d t10k-images-idx3-ubyte.gz</span>
<span class="go">gzip -d t10k-labels-idx1-ubyte.gz</span>
<span class="go">cd ../..</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The links provided above may change. If so, please update the links accordingly.
They were working at the writing of this tutorial: 2023-06-28.</p>
</div>
<p>We can now setup our experiments. Let us first start by doing simple data readers for both datasets. Since it is common code for all experiments, we create a <cite>src</cite> folder in the project root and put a file <cite>data.py</cite> with something like:</p>
<details class="summary-data-py">
<summary>data.py</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_iris</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the IRIS dataset.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the dataset.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X: np.ndarray</span>
<span class="sd">        Features.</span>
<span class="sd">    y: np.ndarray</span>
<span class="sd">        Labels (0, 1, 2).</span>
<span class="sd">    z: list</span>
<span class="sd">        List of class names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If path is a directory, we assume that the dataset is in the directory</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;iris.data&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">path</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">_path</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">z</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>


<span class="k">def</span><span class="w"> </span><span class="nf">load_mnist</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;train&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the MNIST dataset.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>
<span class="sd">        Path to the dataset.</span>

<span class="sd">    kind: str</span>
<span class="sd">        &#39;train&#39; or &#39;test&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X: np.ndarray</span>
<span class="sd">        Features.</span>
<span class="sd">    y: np.ndarray</span>
<span class="sd">        Labels (0, 1, 2).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;train&#39;</span><span class="p">:</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;train-images-idx3-ubyte&#39;</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">_load_mnist_images</span><span class="p">(</span><span class="n">_path</span><span class="p">)</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;train-labels-idx1-ubyte&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_load_mnist_labels</span><span class="p">(</span><span class="n">_path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s1">&#39;test&#39;</span><span class="p">:</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;t10k-images-idx3-ubyte&#39;</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">_load_mnist_images</span><span class="p">(</span><span class="n">_path</span><span class="p">)</span>
        <span class="n">_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;t10k-labels-idx1-ubyte&#39;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">_load_mnist_labels</span><span class="p">(</span><span class="n">_path</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;kind must be either train or test&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_load_mnist_images</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the MNIST images.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    X: np.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">magic</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;big&#39;</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_load_mnist_labels</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load the MNIST labels.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    y: np.ndarray</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">magic</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</details><p>We also add a <cite>__init__.py</cite> file in the <cite>src</cite> folder to make it a python package.</p>
<section id="setting-up-iris-experiment">
<h3><span class="sectnum">2.2.1 </span>Setting up IRIS experiment<a class="headerlink" href="#setting-up-iris-experiment" title="Link to this heading">¶</a></h3>
<p>We can now setup our first experiment. Let us create a folder <cite>summary_statistics</cite> in the <cite>experiments</cite> folder. In this folder, we create a <cite>iris.py</cite> file that will perform some computation of statistics for the IRIS dataset. It will have something like:</p>
<details class="summary-iris-py">
<summary>iris.py</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">importlib.machinery</span><span class="w"> </span><span class="kn">import</span> <span class="n">SourceFileLoader</span>

<span class="c1"># Import the dataset loader by computing relative path</span>
<span class="n">loader_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;../..&#39;</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;data.py&#39;</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">SourceFileLoader</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">loader_path</span><span class="p">)</span><span class="o">.</span><span class="n">load_module</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Iris dataset statistics&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--storage_path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the storage directory of&#39;</span>
                        <span class="s1">&#39;the computed statistics&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--dataset_path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the iris dataset&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># Load the dataset</span>
    <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">classes</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_iris</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">dataset_path</span><span class="p">)</span>

    <span class="c1"># Compute the statistics</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing statistics...&#39;</span><span class="p">)</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Basic statistics</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Basic statistics...&#39;</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nb_samples&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nb_features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nb_classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classes</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Histograms</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Histograms...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">stats</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;hist_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">features</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Correlation matrix</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correlation matrix...&#39;</span><span class="p">)</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;corr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># PCA</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PCA...&#39;</span><span class="p">)</span>
    <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">eig_vals</span><span class="p">,</span> <span class="n">eig_vecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">eig_vals</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">eig_vals</span> <span class="o">=</span> <span class="n">eig_vals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">eig_vecs</span> <span class="o">=</span> <span class="n">eig_vecs</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">]</span>

    <span class="c1"># Compute the projection of the data on the first two principal components</span>
    <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">eig_vecs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">])</span>

    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;pca&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;eig_vals&#39;</span><span class="p">:</span> <span class="n">eig_vals</span><span class="p">,</span> <span class="s1">&#39;eig_vecs&#39;</span><span class="p">:</span> <span class="n">eig_vecs</span><span class="p">,</span> <span class="s1">&#39;proj&#39;</span><span class="p">:</span> <span class="n">proj</span><span class="p">}</span>

    <span class="c1"># Data also stored since it is not too big</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">features</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">labels</span>

    <span class="c1"># Save the statistics</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">storage_path</span><span class="p">,</span> <span class="s1">&#39;stats.pkl&#39;</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Statistics saved in </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">storage_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</details><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Notice that we use the <cite>argparse</cite> module to parse the arguments of the script. Especially we parsed <cite>storage_path</cite>, which allows the script ot know where it should store the result, and <cite>dataset_path</cite> which tells the script where to look for the dataset. Those options will be automatically given by Qanat at experiment execution if the project is configured correctly.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since we placed <cite>src</cite> package in the root of the project, we need to tell python where to find it. This is done by adding the following lines at the beginning of the script:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">importlib.machinery</span><span class="w"> </span><span class="kn">import</span> <span class="n">SourceFileLoader</span>

<span class="c1"># Import the dataset loader by computing relative path</span>
<span class="n">loader_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
       <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;../..&#39;</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;data.py&#39;</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">SourceFileLoader</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">loader_path</span><span class="p">)</span><span class="o">.</span><span class="n">load_module</span><span class="p">()</span>
</pre></div>
</div>
<p>Another way to do this is to add the root of the project to the <cite>PYTHONPATH</cite> environment variable, but this is not recommended as it can lead to conflicts with other projects. You can also add it temporarily with <cite>sys.path.append</cite>.</p>
<p>This is not necessary if the <cite>src</cite> package is in the same folder as the experiment script, but since we want to share the <cite>src</cite> package between experiments, we put it in the root of the project.</p>
</div></blockquote>
</div>
<p>While we are at it, let us create a <cite>plot_iris.py</cite> in the same folder to plot the IRIS dataset as an Action. It will have something like:</p>
<details class="summary-plot-iris-py">
<summary>plot_iris.py</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span>

<span class="c1"># Setup LaTeX for plotting if available</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">usetex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="s1">&#39;serif&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
            <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Plot summary statistics of the iris dataset&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--storage_path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the precomputed summary statistics&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># Load the data</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">storage_path</span><span class="p">,</span> <span class="s1">&#39;stats.pkl&#39;</span><span class="p">),</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="c1"># Plot first order stats as bar plots</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span>
    <span class="n">min_</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
    <span class="n">max_</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;median&#39;</span><span class="p">]</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;classes&#39;</span><span class="p">]</span>
    <span class="n">nb_classes</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nb_classes&#39;</span><span class="p">]</span>
    <span class="n">nb_features</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nb_features&#39;</span><span class="p">]</span>
    <span class="n">nb_samples</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;nb_samples&#39;</span><span class="p">]</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;petal length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width&#39;</span><span class="p">]</span>

    <span class="c1"># First : mean, std, min, max, median, horizontal bar plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">kind</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;median&#39;</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nb_features</span><span class="p">),</span> <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">],</span>
                       <span class="n">tick_label</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nb_features</span><span class="p">),</span> <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">])</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span>

    <span class="c1"># Same info as above but in a box plot for each feature</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_features</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;features&#39;</span><span class="p">][:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">showmeans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">meanline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">meanprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
                    <span class="n">medianprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">},</span>
                    <span class="n">boxprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">},</span>
                    <span class="n">whiskerprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">},</span>
                    <span class="n">capprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nb_features</span><span class="p">),</span> <span class="n">feature_names</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Box plot of the features&#39;</span><span class="p">)</span>

    <span class="c1"># Plot the histogram of each feature sotred in</span>
    <span class="c1"># stats[&#39;hist_i&#39; % feature_no]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_features</span><span class="p">):</span>
        <span class="n">hist</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;hist_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Histogram of </span><span class="si">{</span><span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

    <span class="c1"># Plot the correlation matrix</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;corr&#39;</span><span class="p">],</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nb_features</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nb_features</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span>
               <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation matrix&#39;</span><span class="p">)</span>

    <span class="c1"># Plot the PCA: scatter plot of the first two components</span>
    <span class="c1"># with color indicating the class and eigenvectors as arrows</span>
    <span class="c1"># indicating the direction of the variance</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">eig_vals</span><span class="p">,</span> <span class="n">eig_vecs</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;pca&#39;</span><span class="p">][</span><span class="s1">&#39;eig_vals&#39;</span><span class="p">],</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;pca&#39;</span><span class="p">][</span><span class="s1">&#39;eig_vecs&#39;</span><span class="p">]</span>
    <span class="n">proj</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;pca&#39;</span><span class="p">][</span><span class="s1">&#39;proj&#39;</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">proj</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">proj</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

    <span class="c1"># Plot the eigenvectors</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">]</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">mean</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mean</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                  <span class="n">eig_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">eig_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="n">eig_vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">eig_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                  <span class="n">head_width</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">head_length</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                  <span class="n">fc</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ec</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;PCA: first two components&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;First component&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Second component&#39;</span><span class="p">)</span>

    <span class="c1"># Plot eigenvalues</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nb_features</span><span class="p">),</span> <span class="n">eig_vals</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Eigenvalue index&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Eigenvalue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eigenvalues of the covariance matrix&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</details></section>
<section id="setting-up-the-mnist-experiment">
<h3><span class="sectnum">2.2.2 </span>Setting up the MNIST experiment<a class="headerlink" href="#setting-up-the-mnist-experiment" title="Link to this heading">¶</a></h3>
<p>For MNIST, we can do something similar in the same folder <cite>experiments/summary_statistics</cite> with a <cite>mnist.py</cite> file:</p>
<details class="summary-mnist-py">
<summary>mnist.py</summary><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">importlib.machinery</span><span class="w"> </span><span class="kn">import</span> <span class="n">SourceFileLoader</span>

<span class="c1"># Import the dataset loader by computing relative path</span>
<span class="n">loader_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s1">&#39;../..&#39;</span><span class="p">,</span> <span class="s1">&#39;src&#39;</span><span class="p">,</span> <span class="s1">&#39;data.py&#39;</span><span class="p">)</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">SourceFileLoader</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">loader_path</span><span class="p">)</span><span class="o">.</span><span class="n">load_module</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;MNIST dataset statistics&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--storage_path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the storage directory of&#39;</span>
                        <span class="s1">&#39;the computed statistics&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--dataset_path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Path to the iris dataset&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="c1"># Load the dataset: train and test sets</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_mnist</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">dataset_path</span><span class="p">,</span> <span class="s1">&#39;train&#39;</span><span class="p">)</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">load_mnist</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">dataset_path</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>

    <span class="c1"># Compute the statistics</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Computing statistics...&#39;</span><span class="p">)</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">stats</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Basic statistics</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Basic statistics...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kind</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">],</span>
                        <span class="p">[</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">]):</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;n_samples&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;n_features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;n_classes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;n_samples_per_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># Correlation matrix</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Correlation matrix...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kind</span><span class="p">,</span> <span class="n">X</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">]):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;correlation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># PCA</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;PCA...&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">kind</span><span class="p">,</span> <span class="n">X</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">]):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">rowvar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">cov</span><span class="p">)</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;pca&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;pca&#39;</span><span class="p">][</span><span class="s1">&#39;eigvals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigvals</span>
        <span class="n">stats</span><span class="p">[</span><span class="n">kind</span><span class="p">][</span><span class="s1">&#39;pca&#39;</span><span class="p">][</span><span class="s1">&#39;eigvecs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">eigvecs</span>

    <span class="c1"># Save the statistics</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">storage_path</span><span class="p">,</span> <span class="s1">&#39;stats.pkl&#39;</span><span class="p">),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Statistics saved in </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">storage_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</details><div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <cite>plot_mnist.py</cite> is let as an exercise to the reader.</p>
</div>
</section>
<section id="project-structure">
<h3><span class="sectnum">2.2.3 </span>Project structure<a class="headerlink" href="#project-structure" title="Link to this heading">¶</a></h3>
<p>At this point the project structure should look like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">❯ tree .</span>
<span class="go">.</span>
<span class="go">├── data</span>
<span class="go">│   ├── iris</span>
<span class="go">│   │   ├── bezdekIris.data</span>
<span class="go">│   │   ├── Index</span>
<span class="go">│   │   ├── iris.data</span>
<span class="go">│   │   └── iris.names</span>
<span class="go">│   ├── iris.yaml</span>
<span class="go">│   ├── mnist</span>
<span class="go">│   │   ├── t10k-images-idx3-ubyte</span>
<span class="go">│   │   ├── t10k-labels-idx1-ubyte</span>
<span class="go">│   │   ├── train-images-idx3-ubyte</span>
<span class="go">│   │   └── train-labels-idx1-ubyte</span>
<span class="go">│   └── mnist.yaml</span>
<span class="go">├── experiments</span>
<span class="go">│   └── summary_statistics</span>
<span class="go">│       ├── iris.py</span>
<span class="go">│       ├── mnist.py</span>
<span class="go">│       ├── plot_iris.py</span>
<span class="go">│       └── plot_mnist.py</span>
<span class="go">├── results</span>
<span class="go">└── src</span>
<span class="go">    ├── data.py</span>
<span class="go">    └── __init__.py</span>

<span class="go">7 directories, 18 files</span>
</pre></div>
</div>
</section>
</section>
<section id="adding-datsets-to-the-project">
<h2><span class="sectnum">2.3 </span>Adding datsets to the project<a class="headerlink" href="#adding-datsets-to-the-project" title="Link to this heading">¶</a></h2>
<p>Since we are using datasets, let us formalize this in our project by telling Qanat about them. To do that we can use the command <cite>qanat dataset new</cite> which shows a prompt that allows to tell Qanat what are the names, description, path and tags of the dataset. We can also use a YAML description file. Let us create two files in <cite>data</cite>:</p>
<ul class="simple">
<li><p><cite>iris.yaml</cite>:</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iris</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Iris dataset</span>
<span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/iris</span>
<span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">csv</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">iris</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">classification</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<ul class="simple">
<li><p><cite>mnist.yaml</cite>:</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mnist</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MNIST dataset</span>
<span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/mnist</span>
<span class="nt">tags</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">mnist</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">classification</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">images</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
<p>We can now add those datasets to our project by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">qanat dataset new data/iris.yaml</span>
<span class="go">qanat dataset new data/mnist.yaml</span>
</pre></div>
</div>
<p>We can check that the datasets have been added by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">qanat dataset list</span>
</pre></div>
</div>
<p>which should output something like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Total number of datasets: 2</span>
<span class="go">ID      Name        Description         Path                                               Tags</span>
<span class="go">🆔 2    🔖 iris     💬 Iris dataset     📁 data/iris         🏷  csv, 🏷  iris, 🏷  classification</span>
<span class="go">🆔 3    🔖 mnist    💬 MNIST dataset    📁 data/mnist    🏷  mnist, 🏷  classification, 🏷  images</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We can add a –yes option to the command to avoid the confirmation prompt.</p>
</div>
</section>
<section id="adding-a-new-experiment-thanks-to-a-description-file">
<h2><span class="sectnum">2.4 </span>Adding a new experiment thanks to a description file<a class="headerlink" href="#adding-a-new-experiment-thanks-to-a-description-file" title="Link to this heading">¶</a></h2>
<p>We can now add a new experiment to our project. To that end rather than using the prompt, we can setup a YAML description file. Let us create a folder <cite>experiments_details</cite> in our project root and the file <cite>summary_statistics_iris.yaml</cite> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">summary_iris</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Summary statistics on IRIS dataset</span>
<span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experiments/summary_statistics</span>
<span class="nt">executable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experiments/summary_statistics/iris.py</span>
<span class="nt">executable_command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="nt">datasets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">iris</span>
<span class="nt">tags</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">First-order</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Histograms</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Correlation</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Statistics</span>
<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">plot</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">plot</span>
<span class="w">      </span><span class="nt">executable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experiments/summary_statistics/plot_iris.py</span>
<span class="w">      </span><span class="nt">executable_command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Plot summary statistics about the dataset</span>
</pre></div>
</div>
<p>and the file <cite>summary_statistics_mnist.yaml</cite> with the following content:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">summary_mnist</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Summary statistics on MNIST dataset</span>
<span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experiments/summary_statistics</span>
<span class="nt">executable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experiments/summary_statistics/mnist.py</span>
<span class="nt">executable_command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="nt">datasets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mnist</span>
<span class="nt">tags</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">First-order</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Histograms</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Correlation</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Statistics</span>
<span class="nt">actions</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">plot</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">plot</span>
<span class="w">      </span><span class="nt">executable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">experiments/summary_statistics/plot_mnist.py</span>
<span class="w">      </span><span class="nt">executable_command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Plot summary statistics about the dataset</span>
</pre></div>
</div>
<p>We can now add those experiments to our project by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">qanat experiment new -f experiments_details/summary_statistics_iris.yaml</span>
<span class="go">qanat experiment new -f experiments_details/summary_statistics_mnist.yaml</span>
</pre></div>
</div>
<p>We can check that the experiments have been added by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">qanat experiment list</span>
</pre></div>
</div>
<p>which should output something like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">🆔 ID    🔖 Name          💬 Description              📁 Path                     ⏳ Number of runs                         🏷  Tags</span>

<span class="go"> 1        summary_iris     Summary statistics on       experiments/summary_sta…    0                        First-order, Histograms,</span>
<span class="go">                           IRIS dataset                                                                      Correlation, Statistics</span>

<span class="go"> 2        summary_mnist    Summary statistics on       experiments/summary_sta…    0                        First-order, Histograms,</span>
<span class="go">                           MNIST dataset                                                                     Correlation, Statistics</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We can add a –yes option to the command to avoid the confirmation prompt.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We created the experiments after the datasets. This is important since at the experiment creation we need the name of the datasets that the experiment will use. If we had created the experiments before the datasets, we would have had to edit the experiment description files to add the datasets names.
We can still add new datasets to an experiment after its creation by using the <cite>qanat experiment update</cite> command.</p>
</div>
</section>
<section id="running-the-experiments">
<h2><span class="sectnum">2.5 </span>Running the experiments<a class="headerlink" href="#running-the-experiments" title="Link to this heading">¶</a></h2>
<p>Now that everything is setup for the two first experiments, we can run them. To that end we can use the <cite>qanat experiment run</cite> command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">qanat experiment run summary_iris</span>
<span class="go">qanat experiment run summary_mnist</span>
</pre></div>
</div>
<p>This will run the experiments and store the results in the <cite>results</cite> folder. The first command will have the following output (minus the occasional git commit step):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[10:51:06] INFO     Run 1 created.                                                                                      run.py:1078</span>
<span class="go">           INFO     Setting up the run...                                                                               run.py:1179</span>
<span class="go">           INFO     Single group of parameters detected                                                                 runs.py:209</span>
<span class="go">           INFO     Creating                                                                                            runs.py:210</span>
<span class="go">                    /home/ammarmian/programming_projects/qanat-examples/qanat-tutorials/basics/iris_mnist/results/summa</span>
<span class="go">                    ry_iris/run_1</span>
<span class="go">           INFO     Running the experiment...                                                                           run.py:1188</span>
<span class="go">           INFO     Launching the execution of the run                                                                  runs.py:429</span>
<span class="go">           INFO     Running 1 executions sequentially                                                                   runs.py:545</span>
<span class="go">           INFO     The output of the executions will be redirected to                                                  runs.py:547</span>
<span class="go">                    /home/ammarmian/programming_projects/qanat-examples/qanat-tutorials/basics/iris_mnist/results/summa</span>
<span class="go">                    ry_iris/run_1</span>
<span class="go">           INFO     Running &#39;python experiments/summary_statistics/iris.py --storage_path                               runs.py:568</span>
<span class="go">                    /home/ammarmian/programming_projects/qanat-examples/qanat-tutorials/basics/iris_mnist/results/summa</span>
<span class="go">                    ry_iris/run_1 --dataset_path</span>
<span class="go">                    /home/ammarmian/programming_projects/qanat-examples/qanat-tutorials/basics/iris_mnist/data/iris&#39;</span>
<span class="go">           WARNING  Do not close the terminal window. It will cancel the execution of the run.                          runs.py:569</span>
<span class="go">           INFO     Finished [&#39;python&#39;, &#39;experiments/summary_statistics/iris.py&#39;, &#39;--storage_path&#39;,                     runs.py:606</span>
<span class="go">                    &#39;/home/ammarmian/programming_projects/qanat-examples/qanat-tutorials/basics/iris_mnist/results/summ</span>
<span class="go">                    ary_iris/run_1&#39;, &#39;--dataset_path&#39;,</span>
<span class="go">                    &#39;/home/ammarmian/programming_projects/qanat-examples/qanat-tutorials/basics/iris_mnist/data/iris&#39;]</span>

<span class="go">  Running.. ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100%</span>
<span class="go">           INFO     Updating database with finished time</span>
</pre></div>
</div>
<p>As you can notice, the actual running command has the two options <cite>–storage_path</cite> and <cite>–dataset_path</cite> automatically filled by Qanat.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If multiple datasets are used by the experiment, the <cite>–dataset_path</cite> option will be repeated for each dataset.</p>
</div>
<p>After executing the two commands, we can check that the results have been stored in the <cite>results</cite> folder by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">❯ tree results</span>
<span class="go">results/</span>
<span class="go">├── summary_iris</span>
<span class="go">│   └── run_1</span>
<span class="go">│       ├── group_info.yaml</span>
<span class="go">│       ├── info.yaml</span>
<span class="go">│       ├── stats.pkl</span>
<span class="go">│       ├── stderr.txt</span>
<span class="go">│       └── stdout.txt</span>
<span class="go">└── summary_mnist</span>
<span class="go">    └── run_2</span>
<span class="go">        ├── group_info.yaml</span>
<span class="go">        ├── info.yaml</span>
<span class="go">        ├── stats.pkl</span>
<span class="go">        ├── stderr.txt</span>
<span class="go">        └── stdout.txt</span>

<span class="go">4 directories, 10 files</span>
</pre></div>
</div>
<p>We can also check that the database has been updated by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">❯ qanat experiment status summary_iris</span>
<span class="go"> 🔖 Name: summary_iris</span>
<span class="go"> 💬 Description: Summary statistics on IRIS dataset</span>
<span class="go"> 📁 Path: experiments/summary_statistics</span>
<span class="go"> 💾 Datasets:[&#39;iris&#39;]</span>
<span class="go"> ⚙ Executable: experiments/summary_statistics/iris.py</span>
<span class="go"> ⚙ Execute command: python</span>
<span class="go"> ⏳ Number of runs: 1</span>
<span class="go"> 🏷  Tags: [&#39;First-order&#39;, &#39;Histograms&#39;, &#39;Correlation&#39;, &#39;Statistics&#39;]</span>
<span class="go"> 🛠 Actions:</span>
<span class="go">   - plot: Plot summary statistics about the dataset</span>

<span class="go"> ⏳ Runs:</span>
<span class="go"> 🆔 ID    💬 Description    📁 Path             🖥 Runner    📆 Launch date     ⏱ Duration        🔍 Status    🏷  Tags    ⏳ Progress</span>
<span class="go"> 1                          results/summary…     local      2023-06-29         0:00:00.319506       🏁</span>
<span class="go">                                                            10:51:06.260540</span>
</pre></div>
</div>
<p>To show the plots of the <cite>summary_iris</cite> experiment, we can run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">❯ qanat experiment action summary_iris plot 1</span>
<span class="go">[10:56:17] INFO     Executing action &#39;plot&#39; on run 1 of experiment summary_iris                                       actions.py:94</span>
<span class="go">           INFO     Action command: python experiments/summary_statistics/plot_iris.py --storage_path                actions.py:114</span>
<span class="go">                    results/summary_iris/run_1</span>
</pre></div>
</div>
</section>
<section id="conclusion">
<h2><span class="sectnum">2.6 </span>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>In this tutorial we have seen how to create a project, add datasets and experiments to it, and run the experiments using a YAML description file. In the next tutorial, we will see how to run these experiments as a job on a cluster with a job-submission system.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="run_job_cluster.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="sectnum">3 </span>Running experiments through a job system</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="gettingstarted.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="sectnum">1 </span>Getting Started</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Ammar Mian
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><span class="sectnum">2 </span>Experiments, Datasets and description files</a><ul>
<li><a class="reference internal" href="#objectives"><span class="sectnum">2.1 </span>Objectives</a></li>
<li><a class="reference internal" href="#setting-up-the-project-and-environment"><span class="sectnum">2.2 </span>Setting up the project and environment</a><ul>
<li><a class="reference internal" href="#setting-up-iris-experiment"><span class="sectnum">2.2.1 </span>Setting up IRIS experiment</a></li>
<li><a class="reference internal" href="#setting-up-the-mnist-experiment"><span class="sectnum">2.2.2 </span>Setting up the MNIST experiment</a></li>
<li><a class="reference internal" href="#project-structure"><span class="sectnum">2.2.3 </span>Project structure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-datsets-to-the-project"><span class="sectnum">2.3 </span>Adding datsets to the project</a></li>
<li><a class="reference internal" href="#adding-a-new-experiment-thanks-to-a-description-file"><span class="sectnum">2.4 </span>Adding a new experiment thanks to a description file</a></li>
<li><a class="reference internal" href="#running-the-experiments"><span class="sectnum">2.5 </span>Running the experiments</a></li>
<li><a class="reference internal" href="#conclusion"><span class="sectnum">2.6 </span>Conclusion</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>